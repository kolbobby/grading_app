<script type="text/javascript">
	$(document).ready(function() {
		$('.roster_student_list').each(function() {
			var par = $(this).parent('div').children('h4');
			$.post('/load_student_roster', { activity: par.text() }, function(r) { $(this).html(r); });
		});
	})
</script>
<% @s_a_arr = Array.new %>
<% @activity_arr = Array.new %>
<% @students.each do |s| %>
	<% if !@activity_arr.include?(s.search("activity").inner_text) %>
		<% act = Activity.find(:first, :conditions => { :name => s.search("activity").inner_text, :marking_period => s.search("marking_period").inner_text, :activity_number => s.search("activity_number").inner_text }) %>
		<% if current_user?(User.find(:first, :conditions => { :name => act[:coach] })) %>
			<% @activity_arr.push(s.search("activity").inner_text) %>
			<% @s_a_arr.push(s) %>
		<% end %>
	<% end %>
<% end %>
<div>
	<%= current_user[:name] %><hr />
	<% @s_a_arr.each do |a| %>
		<div class="well">
			<h4><%= a.search("activity").inner_text %> <small>(period: <%= a.search("period").inner_text %>, marking period: <%= a.search("marking_period").inner_text %>)</small></h4>
			<div class="roster_student_list"></div>
		</div>
	<% end %>
</div>